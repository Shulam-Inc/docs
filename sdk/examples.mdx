---
title: "Examples"
description: "Complete code examples for common payment scenarios"
---

# Examples

## Basic Payment

The simplest integration â€” fetch a paid resource with automatic 402 handling.

```typescript
import { createShulamClient } from "@shulam/x402/client";

const client = createShulamClient({
  facilitatorUrl: "https://api.shulam.io",
  signer: walletSigner,
  walletAddress: "0xBuyerAddress",
  maxPaymentUSDC: 100,
});

// Automatically signs and pays when the server returns 402
const response = await client.fetch("https://api.merchant.com/premium-data");
const data = await response.json();
```

## Express Paywall (Server)

Protect any Express route with a USDC paywall:

```typescript
import express from "express";
import { requirePayment } from "@shulam/sdk/express";

const app = express();

app.get(
  "/api/premium",
  requirePayment({ amount: "10000000", payTo: "0xMerchantWallet" }),
  (req, res) => {
    res.json({
      content: "Premium data",
      paidBy: req.payment.payer,
      txHash: req.payment.txHash,
    });
  }
);
```

## React Checkout Page

A complete checkout page with loading states and error handling.

```tsx
import { useState } from "react";
import { useShulamPayment } from "@shulam/x402/react";

function CheckoutPage({ order }) {
  const [content, setContent] = useState(null);
  const { pay, paying, lastReceipt, error } = useShulamPayment({
    facilitatorUrl: "https://api.shulam.io",
    signer: walletSigner,
    walletAddress: "0xBuyerAddress",
    maxDailyUSDC: 100,
  });

  const handleCheckout = async () => {
    const response = await pay(`/api/orders/${order.id}/fulfill`);
    const data = await response.json();
    setContent(data);
  };

  return (
    <div>
      <h2>Order #{order.id}</h2>
      <p>Total: {(Number(order.amount) / 1e6).toFixed(2)} USDC</p>

      {!content && (
        <button onClick={handleCheckout} disabled={paying}>
          {paying ? "Processing..." : `Pay ${(Number(order.amount) / 1e6).toFixed(2)} USDC`}
        </button>
      )}

      {lastReceipt && <p>Payment confirmed! TX: {lastReceipt.txHash}</p>}
      {content && <div>Order fulfilled!</div>}
      {error && <button onClick={() => location.reload()}>Try Again</button>}
    </div>
  );
}
```

## Escrow Payment (Marketplace)

Hold funds in escrow and release when the buyer confirms delivery.

```typescript
// Frontend: buyer pays into escrow
const client = createShulamClient({
  facilitatorUrl: "https://api.shulam.io",
  signer: walletSigner,
  walletAddress: "0xBuyerAddress",
  maxPaymentUSDC: 100,
});

const response = await client.fetch("https://marketplace.com/api/orders/create", {
  method: "POST",
  body: JSON.stringify({ itemId: "item_123" }),
});

const { escrowId } = await response.json();

// Later: buyer confirms delivery via marketplace API
await fetch("https://marketplace.com/api/orders/confirm", {
  method: "POST",
  body: JSON.stringify({ escrowId }),
});
```

## Multi-Endpoint Server

Configure different prices for different endpoints:

```typescript
import { createShulamServer } from "@shulam/x402/server";

const shulam = createShulamServer({
  facilitatorUrl: "https://api.shulam.io",
  sellerAddress: "0xMerchantWallet",
  endpoints: {
    "/api/basic": { amount: "1000000" },    // 1 USDC
    "/api/premium": { amount: "10000000" }, // 10 USDC
    "/api/bulk": { amount: "50000000" },    // 50 USDC
  },
});
```

## Payment Receipt Display

Show the last payment receipt using the React hook:

```tsx
import { useShulamPayment } from "@shulam/x402/react";

function PaymentHistory() {
  const { lastReceipt, dailySpending } = useShulamPayment({
    facilitatorUrl: "https://api.shulam.io",
    signer: walletSigner,
    walletAddress: "0xBuyerAddress",
    maxDailyUSDC: 100,
  });

  return (
    <div>
      <h3>Payment Activity</h3>
      <p>Daily spending: {dailySpending} USDC</p>
      {lastReceipt && (
        <div>
          <p>Last payment: {(Number(lastReceipt.amount) / 1e6).toFixed(2)} USDC</p>
          <p>TX: {lastReceipt.txHash}</p>
          <p>Status: {lastReceipt.settled ? "Settled" : "Pending"}</p>
        </div>
      )}
    </div>
  );
}
```
